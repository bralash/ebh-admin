(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{184:function(e,t,a){"use strict";var s=a(2),r=a(15),i=a(22);t.a=Object(s.a)(r.a,Object(i.b)("form")).extend({name:"v-form",inheritAttrs:!1,props:{lazyValidation:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",t=>{this.$set(this.errorBag,e._uid,t)},{immediate:!0}),a={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?a.shouldValidate=e.$watch("shouldValidate",s=>{s&&(this.errorBag.hasOwnProperty(e._uid)||(a.valid=t(e)))}):a.valid=t(e),a},validate(){return 0===this.inputs.filter(e=>!e.validate(!0)).length},reset(){this.inputs.forEach(e=>e.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(e=>e.resetValidation()),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find(t=>t._uid===e._uid);if(!t)return;const a=this.watchers.find(e=>e._uid===t._uid);a&&(a.valid(),a.shouldValidate()),this.watchers=this.watchers.filter(e=>e._uid!==t._uid),this.inputs=this.inputs.filter(e=>e._uid!==t._uid),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},this.$slots.default)}})},192:function(e,t,a){"use strict";a.r(t);var s={name:"Users",mixins:[{data:function(){return{toast:!1,toastText:""}},methods:{notify:function(e){this.toastText=e,this.toast=!0}}}],data:function(){return{dialog:!1,loading:!0,requesting:!1,showDeleteDialog:!1,activeResource:{name:null},stats:[{name:"Users registered",value:0,color:"blue",icon:"account-multiple"}],users:[],headers:[{text:"Name",value:"name"},{text:"Phone",value:"phone"},{text:"Type",value:"user_type"},{text:"Actions",value:"actions",sortable:!1}],userTypeSelect:[{text:"General",value:1},{text:"Admin",value:5},{text:"Donor",value:2},{text:"Blood bank contact",value:3},{text:"Organization contact",value:4}]}},created:function(){var e=this;this.$dash.resource("users").get("",(function(t){if(t.data){var a=t.data.map((function(e){var t;return(t=e.attributes).id,t.name,t.phone,t.user_type,t}));e.users=a,e.loading=!1,e.stats[0].value=e.users.length}}))},mounted:function(){var e=this,t=this;this.$dash.submitAll("new-user-form",(function(a,s,r){""!=e.$dash.select("[name=type]").value?(t.requesting=!0,e.$dash.resource("users").create(s,(function(a){var s;a.data&&(t.notify("User created successfully"),e.$refs.newUser.reset(),t.dialog=!1,t.users.push(((s=a.data.attributes).id,s.name,s.phone,s.user_type,s)),t.stats[0].value=t.users.length);t.requesting=!1}),{error:function(e){var a=e.errors;t.notify(a[0].detail),t.requesting=!1}})):t.notify("The type field is required")}),(function(e){t.notify("The "+e.inputs[0].name+" is required")}))},methods:{initDelete:function(e){this.showDeleteDialog=!0,this.activeResource=e},deleteResource:function(){var e=this.activeResource.id;this.$dash.resource("users").delete(e,(function(e){e.errors}))}}},r=a(18),i=a(19),n=a.n(i),o=a(47),l=a(42),u=a(21),d=a(190),c=a(184),h=a(64),v=a(146),f=a(39),p=Object(r.a)(s,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("page",{attrs:{name:"Users",desc:"Manage all user accounts"},scopedSlots:e._u([{key:"tools",fn:function(){return[a("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var s=t.on;return[a("v-btn",e._g({attrs:{color:"primary"}},s),[e._v("New ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),a("v-card",[a("v-card-title",{staticClass:"headline font-weight-bold grey lighten-2"},[e._v("\n\t\t\t\t\tUser Profile\n\t\t\t\t")]),e._v(" "),a("v-form",{ref:"newUser",attrs:{id:"new-user-form"}},[a("v-card-text",[a("v-text-field",{attrs:{label:"Name",name:"name",required:""}}),e._v(" "),a("v-text-field",{attrs:{label:"Phone",name:"phone",required:""}}),e._v(" "),a("v-text-field",{attrs:{label:"Password",type:"password",name:"password",required:""}}),e._v(" "),a("v-select",{attrs:{items:e.userTypeSelect,label:"Type",name:"type",filled:"",required:""}})],1),e._v(" "),a("v-card-actions",[a("v-spacer"),e._v(" "),a("v-btn",{attrs:{color:"black",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Close")]),e._v(" "),a("v-btn",{attrs:{loading:e.requesting,color:"primary",type:"submit"}},[e._v("Save")])],1)],1)],1)],1),e._v(" "),a("delete-dialog",{attrs:{show:e.showDeleteDialog,toDelete:e.activeResource.name,resourceType:"User"},on:{delete:e.deleteResource}})]},proxy:!0}])},[e._v(" "),a("stat-card",{attrs:{stats:e.stats}}),e._v(" "),a("Table",{attrs:{headers:e.headers,items:e.users,loading:e.loading},on:{"init-delete":e.initDelete}}),e._v(" "),a("toast",{attrs:{show:e.toast,text:e.toastText}})],1)}),[],!1,null,null,null);t.default=p.exports;n()(p,{VBtn:o.a,VCard:l.a,VCardActions:u.a,VCardText:u.b,VCardTitle:u.c,VDialog:d.a,VForm:c.a,VSelect:h.a,VSpacer:v.a,VTextField:f.a})}}]);