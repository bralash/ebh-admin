(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{186:function(e,t,s){"use strict";var a=s(2),r=s(17),i=s(22);t.a=Object(a.a)(r.a,Object(i.b)("form")).extend({name:"v-form",inheritAttrs:!1,props:{lazyValidation:Boolean,value:Boolean},data:()=>({inputs:[],watchers:[],errorBag:{}}),watch:{errorBag:{handler(e){const t=Object.values(e).includes(!0);this.$emit("input",!t)},deep:!0,immediate:!0}},methods:{watchInput(e){const t=e=>e.$watch("hasError",t=>{this.$set(this.errorBag,e._uid,t)},{immediate:!0}),s={_uid:e._uid,valid:()=>{},shouldValidate:()=>{}};return this.lazyValidation?s.shouldValidate=e.$watch("shouldValidate",a=>{a&&(this.errorBag.hasOwnProperty(e._uid)||(s.valid=t(e)))}):s.valid=t(e),s},validate(){return 0===this.inputs.filter(e=>!e.validate(!0)).length},reset(){this.inputs.forEach(e=>e.reset()),this.resetErrorBag()},resetErrorBag(){this.lazyValidation&&setTimeout(()=>{this.errorBag={}},0)},resetValidation(){this.inputs.forEach(e=>e.resetValidation()),this.resetErrorBag()},register(e){this.inputs.push(e),this.watchers.push(this.watchInput(e))},unregister(e){const t=this.inputs.find(t=>t._uid===e._uid);if(!t)return;const s=this.watchers.find(e=>e._uid===t._uid);s&&(s.valid(),s.shouldValidate()),this.watchers=this.watchers.filter(e=>e._uid!==t._uid),this.inputs=this.inputs.filter(e=>e._uid!==t._uid),this.$delete(this.errorBag,t._uid)}},render(e){return e("form",{staticClass:"v-form",attrs:{novalidate:!0,...this.attrs$},on:{submit:e=>this.$emit("submit",e)}},this.$slots.default)}})},192:function(e,t,s){"use strict";s.d(t,"a",(function(){return a}));var a={data:function(){return{dialog:!1,toast:!1,toastText:"",requesting:!1,showDeleteDialog:!1,activeResource:{name:null}}},methods:{notify:function(e){this.toastText=e,this.toast=!0}}}},195:function(e,t,s){"use strict";s.r(t);var a={name:"Users",mixins:[s(192).a],data:function(){return{loading:!0,stats:[{name:"Users registered",value:0,color:"blue",icon:"account-multiple"}],users:[],headers:[{text:"Name",value:"name"},{text:"Phone",value:"phone"},{text:"Type",value:"user_type"},{text:"Actions",value:"actions",sortable:!1}],userTypeSelect:[{text:"General",value:1},{text:"Admin",value:5},{text:"Donor",value:2},{text:"Blood bank contact",value:3},{text:"Organization contact",value:4}]}},created:function(){var e=this;this.$dash.resource("users").get("",(function(t){if(t.data){var s=t.data.map((function(e){var t;return(t=e.attributes).id,t.name,t.phone,t.user_type,t}));e.users=s,e.loading=!1,e.stats[0].value=e.users.length}}))},mounted:function(){var e=this,t=this;this.$dash.submitAll("new-user-form",(function(s,a,r){""!=e.$dash.select("[name=type]").value?(t.requesting=!0,e.$dash.resource("users").create(a,(function(s){var a;s.data&&(t.notify("User created successfully"),e.$refs.newUser.reset(),t.dialog=!1,t.users.push(((a=s.data.attributes).id,a.name,a.phone,a.user_type,a)),t.stats[0].value=t.users.length);t.requesting=!1}),{error:function(e){var s=e.errors;t.notify(s[0].detail),t.requesting=!1}})):t.notify("The type field is required")}),(function(e){t.notify("The "+e.inputs[0].name+" is required")}))},methods:{initDelete:function(e){this.showDeleteDialog=!0,this.activeResource=e},deleteResource:function(){var e=this,t=this.activeResource.id,s=this;this.$dash.resource("users").delete(t,(function(a){a.errors||(e.showDeleteDialog=!1,s.notify(a.meta.message),e.users.splice(e.users.findIndex((function(e){return e.id==t})),1),s.stats[0].value=s.users.length)}))}}},r=s(15),i=s(16),n=s.n(i),o=s(47),u=s(42),l=s(21),d=s(191),c=s(186),h=s(65),v=s(150),f=s(39),p=Object(r.a)(a,(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("page",{attrs:{name:"Users",desc:"Manage all user accounts"},scopedSlots:e._u([{key:"tools",fn:function(){return[s("v-dialog",{attrs:{persistent:"","max-width":"600px"},scopedSlots:e._u([{key:"activator",fn:function(t){var a=t.on;return[s("v-btn",e._g({attrs:{color:"primary"}},a),[e._v("New ")])]}}]),model:{value:e.dialog,callback:function(t){e.dialog=t},expression:"dialog"}},[e._v(" "),s("v-card",[s("v-card-title",{staticClass:"headline font-weight-bold grey lighten-2"},[e._v("\n\t\t\t\t\tUser Profile\n\t\t\t\t")]),e._v(" "),s("v-form",{ref:"newUser",attrs:{id:"new-user-form"}},[s("v-card-text",[s("v-text-field",{attrs:{label:"Name",name:"name",required:""}}),e._v(" "),s("v-text-field",{attrs:{label:"Phone",name:"phone",required:""}}),e._v(" "),s("v-text-field",{attrs:{label:"Password",type:"password",name:"password",required:""}}),e._v(" "),s("v-select",{attrs:{items:e.userTypeSelect,label:"Type",name:"type",filled:"",required:""}})],1),e._v(" "),s("v-card-actions",[s("v-spacer"),e._v(" "),s("v-btn",{attrs:{color:"black",text:""},on:{click:function(t){e.dialog=!1}}},[e._v("Close")]),e._v(" "),s("v-btn",{attrs:{loading:e.requesting,color:"primary",type:"submit"}},[e._v("Save")])],1)],1)],1)],1),e._v(" "),s("delete-dialog",{attrs:{show:e.showDeleteDialog,toDelete:e.activeResource.name,resourceType:"User"},on:{delete:e.deleteResource}})]},proxy:!0}])},[e._v(" "),s("stat-card",{attrs:{stats:e.stats}}),e._v(" "),s("Table",{attrs:{headers:e.headers,items:e.users,loading:e.loading},on:{"init-delete":e.initDelete}}),e._v(" "),s("toast",{attrs:{show:e.toast,text:e.toastText}})],1)}),[],!1,null,null,null);t.default=p.exports;n()(p,{VBtn:o.a,VCard:u.a,VCardActions:l.a,VCardText:l.b,VCardTitle:l.c,VDialog:d.a,VForm:c.a,VSelect:h.a,VSpacer:v.a,VTextField:f.a})}}]);